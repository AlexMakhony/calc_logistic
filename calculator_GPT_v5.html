<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–õ–æ–≥—ñ—Å—Ç–∏—á–Ω–∏–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä ‚Äî 20—Ç (—Ç–µ–Ω—Ç/—Ä–µ—Ñ)</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-slate-50 min-h-screen p-6">
    <div id="root"></div>
    <script type="text/babel" data-presets="react">
      const { useState, useMemo } = React;

      const DRIVER = { perKmUA: 0.07, perKmEU: 0.12, monthlySalaryTaxes: 673, perDiemUA: 7.11, businessTripEU: 222 };
      const DIRECT = { exploitationPerKm: 0.16, permitsEUPerKm: 0.24, permitsUAPerKm: 0.02, orgPerKm: 0.11, depreciationPerKm: 0.09, parkingPerTrip: 77.7 };
      const INDIRECT_MONTHLY = { overhead: 550, admin: 280 };
      const FUEL = { emptyLper100: 28, loadedLper100: 34, reeferAutoLPerDay: 30, reeferNonstopLPerDay: 84, priceUA: 1.23, priceEU: 2.0 };
      const fmt = (n) => n.toLocaleString(undefined, { maximumFractionDigits: 2, minimumFractionDigits: 2 });

      function LogisticCalculator() {
        const [inputs, setInputs] = useState({ tripType: '–º—ñ–∂–Ω–∞—Ä–æ–¥–Ω–∏–π', cargoType: '—Ç–µ–Ω—Ç', freightUSD: '', kmUA: '', kmEU: '', daysUA: '', daysEU: '', otherBonuses: '', emptySharePct: '', ferryCost: '' });
        const isInternational = inputs.tripType === '–º—ñ–∂–Ω–∞—Ä–æ–¥–Ω–∏–π';
        const kmEU = isInternational ? +inputs.kmEU || 0 : 0;
        const daysEU = isInternational ? +inputs.daysEU || 0 : 0;
        const daysUA = (+inputs.daysUA || 0);
        const kmUA = (+inputs.kmUA || 0);
        const totalKm = kmUA + kmEU;
        const totalDays = daysUA + daysEU;

        const results = useMemo(() => {
          // ==== FUEL ====
          const emptyKm = totalKm * ((+inputs.emptySharePct || 0) / 100);
          const loadedKm = Math.max(totalKm - emptyKm, 0);
          const litersDriving = (loadedKm * FUEL.loadedLper100 + emptyKm * FUEL.emptyLper100) / 100;
          const shareEU = totalKm > 0 ? kmEU / totalKm : 0;
          const litersUA = litersDriving * (1 - shareEU);
          const litersEU = litersDriving * shareEU;
          let reeferLitersUA = 0, reeferLitersEU = 0;
          if (inputs.cargoType.includes('–†–ï–§')) {
            const rate = inputs.cargoType === '–†–ï–§(–∞–≤—Ç–æ)' ? FUEL.reeferAutoLPerDay : FUEL.reeferNonstopLPerDay;
            reeferLitersUA = rate * daysUA;
            reeferLitersEU = rate * daysEU;
          }
          const fuelCostUA = (litersUA + reeferLitersUA) * FUEL.priceUA;
          const fuelCostEU = (litersEU + reeferLitersEU) * FUEL.priceEU;
          const fuelTotal = fuelCostUA + fuelCostEU;

          // ==== DRIVER (breakdown) ====
          const isRC = inputs.tripType === '–†–¶';
          const motivation = isRC ? 24 * daysUA : (kmUA * DRIVER.perKmUA + kmEU * DRIVER.perKmEU);
          const perDiems = isRC ? 0 : (daysUA * DRIVER.perDiemUA + (isInternational && daysEU > 0 ? DRIVER.businessTripEU : 0));
          const salaryAlloc = (DRIVER.monthlySalaryTaxes / 30) * totalDays;
          const driverTotal = motivation + perDiems + salaryAlloc;

          // ==== DIRECT (breakdown) ====
          const directExploit = totalKm * DIRECT.exploitationPerKm;
          const directOrg = totalKm * DIRECT.orgPerKm + (+inputs.ferryCost || 0);
          const directDepr = totalKm * DIRECT.depreciationPerKm;
          const directPermitEU = kmEU * DIRECT.permitsEUPerKm;
          const directPermitUA = kmUA * DIRECT.permitsUAPerKm;
          const directParking = isInternational ? DIRECT.parkingPerTrip : 0;
          const directTotal = directExploit + directOrg + directDepr + directPermitEU + directPermitUA + directParking;

          // ==== INDIRECT ====
          const indirectAlloc = ((INDIRECT_MONTHLY.overhead + INDIRECT_MONTHLY.admin) / 30) * totalDays;

          // ==== REVENUE & PROFIT ====
          const revenue = (+inputs.freightUSD || 0) + (+inputs.otherBonuses || 0);
          const grossProfit = revenue - fuelTotal - driverTotal - directTotal;
          const netProfit = grossProfit - indirectAlloc;
          const profitPerKm = totalKm > 0 ? netProfit / totalKm : 0;

          return {
            revenue, grossProfit, netProfit, profitPerKm,
            fuelTotal, fuelCostUA, fuelCostEU,
            driverTotal, motivation, perDiems, salaryAlloc,
            directTotal, directExploit, directOrg, directDepr, directPermitEU, directPermitUA, directParking,
            totalKm, totalDays
          };
        }, [inputs, totalKm, totalDays, kmUA, kmEU, daysUA, daysEU, isInternational]);

        const set = (k, v) => setInputs({ ...inputs, [k]: v });

        const KPI = [
          ['–î–æ—Ö–æ–¥', results.revenue],
          ['–ì–°–ú (—Ä–∞–∑–æ–º)', results.fuelTotal],
          ['–ú–æ—Ç–∏–≤–∞—Ü—ñ—è –≤–æ–¥—ñ—è', results.driverTotal],
          ['–ü—Ä—è–º—ñ –≤–∏—Ç—Ä–∞—Ç–∏', results.directTotal],
          ['–í–∞–ª–æ–≤–∏–π –ø—Ä–∏–±—É—Ç–æ–∫', results.grossProfit],
          ['–ß–∏—Å—Ç–∏–π –ø—Ä–∏–±—É—Ç–æ–∫', results.netProfit],
          ['–ü—Ä–∏–±—É—Ç–æ–∫ / –∫–º', results.profitPerKm]
        ];

        const getColorClass = (label, val) => {
          const highlight = ['–í–∞–ª–æ–≤–∏–π –ø—Ä–∏–±—É—Ç–æ–∫', '–ß–∏—Å—Ç–∏–π –ø—Ä–∏–±—É—Ç–æ–∫', '–ü—Ä–∏–±—É—Ç–æ–∫ / –∫–º'];
          if (!highlight.includes(label)) return 'text-gray-900';
          return val >= 0 ? 'text-emerald-600' : 'text-rose-600';
        };

        return (
          <div className="max-w-6xl mx-auto">
            <h1 className="text-3xl font-bold mb-4">–õ–æ–≥—ñ—Å—Ç–∏—á–Ω–∏–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä ‚Äî 20—Ç (—Ç–µ–Ω—Ç/—Ä–µ—Ñ)</h1>
            <div className="grid md:grid-cols-3 gap-4">
              <div className="space-y-3">
                <Card title="–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ä–µ–π—Å—É">
                  <Select label="–¢–∏–ø —Ä–µ–π—Å—É" value={inputs.tripType} options={['–≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π','–º—ñ–∂–Ω–∞—Ä–æ–¥–Ω–∏–π','–†–¶']} onChange={(e)=>set('tripType',e.target.value)} />
                  <Select label="–¢–∏–ø –≤–∞–Ω—Ç–∞–∂—É" value={inputs.cargoType} options={['—Ç–µ–Ω—Ç','–†–ï–§(–∞–≤—Ç–æ)','–†–ï–§(–Ω–æ–Ω—Å—Ç–æ–ø)']} onChange={(e)=>set('cargoType',e.target.value)} />
                  <Input label="–§—Ä–∞—Ö—Ç, $" value={inputs.freightUSD} onChange={(e)=>set('freightUSD',e.target.value)} />
                  <Input label="–Ü–Ω—à—ñ –ø—Ä–µ–º—ñ—ó, $" value={inputs.otherBonuses} onChange={(e)=>set('otherBonuses',e.target.value)} />
                  <Input label="–ü–∞—Ä–æ–º, $" value={inputs.ferryCost} onChange={(e)=>set('ferryCost',e.target.value)} />
                </Card>
                <Card title="–ü—Ä–æ–±—ñ–≥ —Ç–∞ —á–∞—Å">
                  <Input label="–ü—Ä–æ–±—ñ–≥ UA, –∫–º" value={inputs.kmUA} onChange={(e)=>set('kmUA',e.target.value)} />
                  <Input label="–ü—Ä–æ–±—ñ–≥ –Ñ–°, –∫–º" value={inputs.kmEU} onChange={(e)=>set('kmEU',e.target.value)} disabled={!isInternational} />
                  <Input label="–î–Ω—ñ–≤ UA" value={inputs.daysUA} onChange={(e)=>set('daysUA',e.target.value)} />
                  <Input label="–î–Ω—ñ–≤ –Ñ–°" value={inputs.daysEU} onChange={(e)=>set('daysEU',e.target.value)} disabled={!isInternational} />
                  <Input label="–ü—É—Å—Ç–∏–π –ø—Ä–æ–±—ñ–≥, %" value={inputs.emptySharePct} onChange={(e)=>set('emptySharePct',e.target.value)} />
                </Card>
              </div>
              <div className="md:col-span-2 space-y-4">
                <Card title="–†–µ–∑—É–ª—å—Ç–∞—Ç–∏">
                  <div className="grid md:grid-cols-2 gap-2">
                    {KPI.map(([label,val])=> (
                      <div key={label} className="p-3 border rounded-xl bg-white flex justify-between">
                        <span>{label}</span>
                        <b className={getColorClass(label, val)}>${fmt(val)}</b>
                      </div>
                    ))}
                  </div>
                  <div className="mt-3 text-sm text-gray-600">–ó–∞–≥–∞–ª—å–Ω–∏–π –ø—Ä–æ–±—ñ–≥: {fmt(results.totalKm)} –∫–º, –î–Ω—ñ–≤ —É —Ä–µ–π—Å—ñ: {fmt(results.totalDays)}.</div>
                </Card>

                <Card title="–ú–æ—Ç–∏–≤–∞—Ü—ñ—è –≤–æ–¥—ñ—è ‚Äî –¥–µ—Ç–∞–ª—å–Ω–æ">
                  <DetailRow label={"–ú–æ—Ç–∏–≤–∞—Ü—ñ—è (–∫–º –∞–±–æ 24$√ó–¥–Ω—ñ UA)"} value={results.motivation} />
                  <DetailRow label={"–î–æ–±–æ–≤—ñ —Ç–∞ –≤—ñ–¥—Ä—è–¥–∂–µ–Ω–Ω—è"} value={results.perDiems} />
                  <DetailRow label={"–ó–∞—Ä–ø–ª–∞—Ç–∞+–ø–æ–¥–∞—Ç–∫–∏ (–∞–ª–æ–∫–∞—Ü—ñ—è)"} value={results.salaryAlloc} />
                  <div className="mt-2 pt-2 border-t flex justify-between font-semibold">
                    <span>–†–∞–∑–æ–º –º–æ—Ç–∏–≤–∞—Ü—ñ—è</span><span>${fmt(results.driverTotal)}</span>
                  </div>
                </Card>

                <Card title="–ü—Ä—è–º—ñ –≤–∏—Ç—Ä–∞—Ç–∏ ‚Äî –¥–µ—Ç–∞–ª—å–Ω–æ">
                  <DetailRow label={"–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è (–ø–µ—Ä–µ–≤–µ–∑–µ–Ω–Ω—è)/–∫–º"} value={results.directExploit} />
                  <DetailRow label={"–û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω—ñ/–∫–º (–≤–∫–ª. –ø–∞—Ä–æ–º)"} value={results.directOrg} />
                  <DetailRow label={"–ê–º–æ—Ä—Ç–∏–∑–∞—Ü—ñ—è/–∫–º"} value={results.directDepr} />
                  <DetailRow label={"–î–æ–∑–≤–æ–ª–∏ –Ñ–°"} value={results.directPermitEU} />
                  <DetailRow label={"–î–æ–∑–≤–æ–ª–∏ –£–∫—Ä–∞—ó–Ω–∞"} value={results.directPermitUA} />
                  <DetailRow label={"–°—Ç–æ—è–Ω–∫–∏/—Ä–µ–π—Å (—Ç—ñ–ª—å–∫–∏ –¥–ª—è –º—ñ–∂–Ω–∞—Ä–æ–¥–Ω–∏—Ö)"} value={results.directParking} />
                  <div className="mt-2 pt-2 border-t flex justify-between font-semibold">
                    <span>–†–∞–∑–æ–º –ø—Ä—è–º—ñ –≤–∏—Ç—Ä–∞—Ç–∏</span><span>${fmt(results.directTotal)}</span>
                  </div>
                </Card>

                <Card title="–ü–∞–ª–∏–≤–æ ‚Äî –¥–æ–≤—ñ–¥–∫–∞">
                  <DetailRow label={"–ü–∞–ª—å–Ω–µ –≤ –£–∫—Ä–∞—ó–Ω—ñ"} value={results.fuelCostUA} />
                  <DetailRow label={"–ü–∞–ª—å–Ω–µ –≤ –Ñ–°"} value={results.fuelCostEU} />
                  <div className="mt-2 pt-2 border-t flex justify-between font-semibold">
                    <span>–†–∞–∑–æ–º –ø–∞–ª–∏–≤–æ</span><span>${fmt(results.fuelTotal)}</span>
                  </div>
                </Card>

                <Card title="–í–µ—Ä–¥–∏–∫—Ç">
                  {results.netProfit >= 0 ? <div className="text-emerald-700 font-bold">–†–µ–π—Å –≤–∏–≥—ñ–¥–Ω–∏–π üëç</div> : <div className="text-rose-700 font-bold">–†–µ–π—Å –∑–±–∏—Ç–∫–æ–≤–∏–π ‚ö†Ô∏è</div>}
                </Card>
              </div>
            </div>
          </div>
        );
      }

      function Card({ title, children }) {return (<div className="bg-white rounded-2xl shadow p-4 border"><h2 className="text-lg font-semibold mb-2">{title}</h2>{children}</div>);}      
      function Select({ label, value, onChange, options }) {return (<div><label className="text-sm text-gray-600">{label}</label><select className="border rounded-xl px-2 py-1 w-full" value={value} onChange={onChange}>{options.map(o=><option key={o} value={o}>{o}</option>)}</select></div>);}      
      function Input({ label, value, onChange, disabled }) {
        return (
          <div>
            <label className="text-sm text-gray-600">{label}</label>
            <input
              type="number"
              disabled={disabled}
              value={value}
              onChange={onChange}
              onFocus={(e) => { if (e.target.value === '0' || e.target.value === '') e.target.value = ''; onChange(e); }}
              className="border rounded-xl px-2 py-1 w-full"
            />
          </div>
        );
      }
      function DetailRow({ label, value }) {
        return (
          <div className="flex justify-between py-1 text-sm">
            <span className="text-slate-600">{label}</span>
            <span className="font-medium">${fmt(value)}</span>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById('root')).render(<LogisticCalculator />);
    </script>
  </body>
</html>



